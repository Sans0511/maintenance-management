generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

enum Status {
  ACTIVE
  INACTIVE
}

enum AssetStatus {
  ACTIVE
  INACTIVE
  DISPOSED
}

enum InventoryType {
  PURCHASE
  ISSUE
  ADJUSTMENT
}

enum ReturnReason {
  UPGRADE
  REPAIR
  RESIGNATION
}

enum Role {
  USER
  ADMIN
}

model User {
  id             String            @id @default(auto()) @map("_id") @db.ObjectId
  email          String            @unique
  password       String
  role           Role              @default(USER)
  status         Status            @default(ACTIVE)
  employeeId     String?           @db.ObjectId
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt

  employee        Employee?         @relation(fields: [employeeId], references: [id])
  assetAssignments AssetAssignment[]
}

model AssetCategory {
  id                  String     @id @default(auto()) @map("_id") @db.ObjectId
  categoryName        String
  categoryDescription String?
  parentCategoryId    String?    @db.ObjectId
  status              Status     @default(ACTIVE)
  createdAt           DateTime   @default(now())
  updatedAt           DateTime   @updatedAt
  assets              Asset[]
}

model Asset {
  id               String            @id @default(auto()) @map("_id") @db.ObjectId
  assetName        String
  assetDescription String?
  categoryId       String            @db.ObjectId
  locationId       String?           @db.ObjectId
  serialNumber     String            @unique
  status           AssetStatus       @default(ACTIVE)
  createdAt        DateTime          @default(now())
  updatedAt        DateTime          @updatedAt
  assetCategory    AssetCategory     @relation(fields: [categoryId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  location         Location?         @relation(fields: [locationId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  inventories      Inventory[]
  assetAssignments AssetAssignment[]
}

model Inventory {
  id            String         @id @default(auto()) @map("_id") @db.ObjectId
  assetId       String         @db.ObjectId
  inventoryType InventoryType
  quantity      Int            @default(0)
  remarks       String?
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  asset         Asset          @relation(fields: [assetId], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model AssetAssignment {
  id            String         @id @default(auto()) @map("_id") @db.ObjectId
  userId        String         @db.ObjectId
  assetId       String         @db.ObjectId
  issueDate     DateTime
  returnDate    DateTime?
  returnReason  String?
  isReturn      Boolean        @default(false)
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  assignedTo    User?          @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  assignedAsset Asset?         @relation(fields: [assetId], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Designation {
  id              String   @id @default(auto()) @map("_id") @db.ObjectId
  designationName String
  status          Status   @default(ACTIVE)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  employees       Employee[]
}

model EmployeeType {
  id                String   @id @default(auto()) @map("_id") @db.ObjectId
  employeeTypeName  String
  status            Status   @default(ACTIVE)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  employees         Employee[]
}

model Department {
  id             String   @id @default(auto()) @map("_id") @db.ObjectId
  departmentName String
  status         Status   @default(ACTIVE)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  employees      Employee[]
}

model Location {
  id            String   @id @default(auto()) @map("_id") @db.ObjectId
  locationName  String
  status        Status   @default(ACTIVE)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  assets        Asset[]
}

model Contract {
  id            String   @id @default(auto()) @map("_id") @db.ObjectId
  contractName  String
  sphoneNumber  String
  status        Status   @default(ACTIVE)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  employees     Employee[]
}

model Employee {
  id                String   @id @default(auto()) @map("_id") @db.ObjectId
  employeeId        String?
  employeeFirstName String
  employeeLastName  String
  departmentId      String?  @db.ObjectId
  designationId     String   @db.ObjectId
  employeeTypeId    String   @db.ObjectId
  contractId        String?  @db.ObjectId
  phoneNo           String   @unique
  status            Status   @default(ACTIVE)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  department   Department? @relation(fields: [departmentId], references: [id])
  designation  Designation @relation(fields: [designationId], references: [id])
  employeeType EmployeeType @relation(fields: [employeeTypeId], references: [id])
  contract     Contract?   @relation(fields: [contractId], references: [id])
  users        User[]
}
